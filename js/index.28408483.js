(function(t){function e(e){for(var n,s,o=e[0],c=e[1],u=e[2],f=0,m=[];f<o.length;f++)s=o[f],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&m.push(a[s][0]),a[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(m.length)m.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],n=!0,o=1;o<r.length;o++){var c=r[o];0!==a[c]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=r[0]))}return t}var n={},a={index:0},i=[];function s(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=n,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(r,n,function(e){return t[e]}.bind(null,n));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;i.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("066e")},"066e":function(t,e,r){"use strict";r.r(e);r("cadf"),r("551c"),r("f751"),r("097d");var n=r("2b0e"),a=r("8c4f"),i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-layout",{staticClass:"mobile-layout",attrs:{view:"lHh Lpr lFf"}},[r("q-page-container",[r("router-view")],1)],1)},s=[],o=r("d225"),c=r("308d"),u=r("6bb5"),l=r("4e2b"),f=r("9ab4"),m=r("60a3"),d=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),e}(m["d"]);d=Object(f["a"])([m["a"]],d);var h=d,p=h,b=(r("4800"),r("2877")),v=Object(b["a"])(p,i,s,!1,null,"e6029004",null),g=v.exports,y=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",{staticClass:"room-page flex column"},[r("div",{staticClass:"room-header q-pa-md column justify-between"},[r("div",{staticClass:"row justify-between"},[r("div",{staticClass:"room-logo"},[r("div",{staticClass:"q-ml-xs"},[t._v("Lucky")]),r("div",{staticClass:"q-ml-lg"},[t._v("Draw")])])]),r("div",{staticClass:"row justify-between room-info"},[r("div",[r("div",{staticClass:"room-name"},[t._v(t._s(t.roomAttr.name))]),r("div",[r("q-icon",{staticClass:"q-ma-xs",attrs:{size:"20px",name:"account_circle"}}),r("span",{staticClass:"q-ma-xs"},[t._v(t._s(t.userList.length))]),r("span",{staticClass:"q-ma-xs"},[t._v("/")]),r("span",{staticClass:"q-ma-xs"},[t._v(t._s(t.roomAttr.limit))])],1)])])]),r("q-splitter",{staticClass:"panel-container",attrs:{value:6,horizontal:""},scopedSlots:t._u([{key:"before",fn:function(){return[r("q-tabs",{attrs:{"narrow-indicator":"",dense:"",align:"justify"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[r("q-tab",{attrs:{name:"room",label:"房间用户"}}),r("q-tab",{attrs:{name:"award",label:"奖项列表"}}),r("q-tab",{attrs:{name:"mine",label:"我的奖项"}})],1)]},proxy:!0},{key:"after",fn:function(){return[r("q-tab-panels",{staticClass:"panel-list",attrs:{animated:"","keep-alive":"","transition-prev":"fade","transition-next":"fade"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[r("q-tab-panel",{attrs:{name:"room"}},[r("div",{staticClass:"flex row"},t._l(t.userList,(function(t){return r("q-avatar",{key:t.username,staticClass:"q-ma-md",attrs:{size:"48px"}},[r("img",{attrs:{src:t.avatar}})])})),1)]),r("q-tab-panel",{attrs:{name:"award"}},t._l(t.awardList,(function(e){return r("q-card",{key:e.id,staticClass:"award-card"},[r("q-card-section",{staticClass:"flex row justify-between award-title"},[r("div",[r("span",{staticClass:"q-mr-sm"},[t._v(t._s(e.name))]),r("q-badge",{attrs:{"text-color":"black",color:"yellow-6",label:e.count}})],1),r("div",[t._v(t._s(e.finish?"已开奖":"待开奖"))])]),e.finish?r("q-card-section",t._l(t.getAwardResult(e.result),(function(t){return r("q-avatar",{key:t.username,staticClass:"q-ma-md",attrs:{size:"42px"}},[r("img",{attrs:{src:t.avatar}})])})),1):t._e()],1)})),1),r("q-tab-panel",{attrs:{name:"mine"}},t._l(t.awardList,(function(e){return r("q-card",{key:e.objectId,staticClass:"award-card"},[r("q-card-section",{staticClass:"flex row justify-between award-title"},[r("div",[r("span",{staticClass:"q-mr-sm"},[t._v(t._s(e.name))]),r("q-badge",{attrs:{"text-color":"black",color:"yellow-6",label:e.count}})],1),r("div",{staticClass:"absolute-right q-mr-md q-mt-md",class:[t.luckerIsMe(e)?"text-deep-orange-13":"text-grey-13"]},[t._v("\n                "+t._s(e.finish?t.luckerIsMe(e)?"已中奖":"未中奖":"待开奖")+"\n              ")])])],1)})),1)],1)]},proxy:!0}])})],1)},w=[],j=(r("6762"),r("2fdb"),r("96cf"),r("3b8d")),O=r("b0b4"),k=(r("7514"),r("768b")),x=(r("ffc1"),r("ac6a"),r("6b54"),r("0631")),q=r.n(x),_=r("72fe"),C=r.n(_),R=r("75fc"),S=r("2f62"),E=r("0e44");n["a"].use(S["a"]);var L=new S["a"].Store({state:{rooms:new Array,history:new Array,name:"",visitor:{username:"",avatar:""}},mutations:{addRoom:function(t,e){t.rooms=[].concat(Object(R["a"])(t.rooms),[e])},addHistory:function(t,e){t.history=[].concat(Object(R["a"])(t.history),[e])},setHost:function(t){t.name="host:".concat(Math.random().toString(36).substr(2))},setVisitor:function(t,e){var r=e.username,n=e.avatar;t.visitor={username:r,avatar:n}}},actions:{},plugins:[Object(E["a"])({key:"vuex",paths:["rooms","history","name"]})]}),A=(r("8e6e"),r("456d"),r("bd86"));function $(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function P(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?$(r,!0).forEach((function(e){Object(A["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var U=function(){function t(e){Object(o["a"])(this,t),this._object=e}return Object(O["a"])(t,[{key:"valid",value:function(){return this._object&&this._object instanceof q.a.Object}},{key:"object",get:function(){if(!this.valid)throw new Error("entity not init");return this._object}},{key:"attributes",get:function(){return P({},this.object.attributes,{id:this.id})}},{key:"value",get:function(){return this.object.attributes}},{key:"id",get:function(){return this.object.id}},{key:"get",get:function(){return this.object.get}},{key:"set",get:function(){return this._object.set.bind(this._object)}},{key:"save",get:function(){return this._object.save.bind(this._object)}},{key:"fetch",get:function(){return this._object.fetch.bind(this._object)}}],[{key:"from",value:function(e,r){if(!e)throw Error("数据实体不能为空");var n=function(t){return e instanceof Array?e.map((function(e){return t()})):t()};return n(r?function(){return new r(e)}:function(){return new t(e)})}}]),t}(),D=(r("7f7f"),r("4fe3")),M=r("e9b9"),Q=function(){function t(){Object(o["a"])(this,t)}return Object(O["a"])(t,[{key:"getClient",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t._client){e.next=3;break}return e.next=3,this.createClient();case 3:return e.abrupt("return",t._client);case 4:case"end":return e.stop()}}),e,this)})));function r(){return e.apply(this,arguments)}return r}()},{key:"createClient",value:function(){var e=this;return globalThis.$realtime.createIMClient(L.state.visitor.username||L.state.name).then((function(r){t._client=r,t._client.on(D["Event"].MEMBERS_JOINED,e.onMembersEvent),t._client.on(D["Event"].MEMBERS_LEFT,e.onMembersEvent),t._client.on(D["Event"].MESSAGE,e.onMessageEvent)})).catch(console.error)}},{key:"createConversation",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getClient();case 2:return r=t.sent,t.abrupt("return",r.createConversation({members:[],name:e,unique:!0}));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getConversation",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getClient();case 2:return r=t.sent,t.abrupt("return",r.getConversation(e).then((function(t){return t.join(),t})).catch(console.error.bind(console)));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"addUserListener",value:function(e){return new M["a"]((function(r){var n=t._listeners.find((function(t){return t.conversation.id===e.id}));n?n.user=r:t._listeners.push({conversation:e,user:r})}))}},{key:"addUMessageListener",value:function(e){return new M["a"]((function(r){var n=t._listeners.find((function(t){return t.conversation.id===e.id}));n?n.message=r:t._listeners.push({conversation:e,message:r})}))}},{key:"onMembersEvent",value:function(e,r){t._listeners.forEach((function(t){var e=t.user;e&&r.fetch().then((function(t){var r=t.members;e.next(r)}))}))}},{key:"onMessageEvent",value:function(e,r){t._listeners.forEach((function(t){var r=t.message;r&&r.next(e.text)}))}}]),t}();Q._listeners=[];r("55dd");var I=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"setResult",value:function(t,e){var r=new T;return r.setResult(this.object,t,e)}}]),e}(U),N=q.a.Object.extend("award"),T=function(){function t(){Object(o["a"])(this,t)}return Object(O["a"])(t,[{key:"getAward",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=q.a.Object.createWithoutData("award",e),t.abrupt("return",r.fetch({include:["room"]}).then((function(t){return U.from(t,I)})));case 2:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"setResult",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(e){var r,n,a,i,s,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:1,o.length>2?o[2]:void 0,n=e.get("room"),a=U.from(n,J),t.next=6,a.getConversation();case 6:if(i=t.sent,i){t.next=9;break}return t.abrupt("return",Promise.reject("房间未启用"));case 9:if(!(i.members.length<r)){t.next=11;break}return t.abrupt("return",Promise.reject("开奖用户不足"));case 11:return s=i.members.filter((function(t){return!t.includes("host")})).map((function(t){return{id:t,seed:Math.random()}})).sort((function(t,e){return t.seed-e.seed})).slice(0,r),e.set("result",s),e.set("finish",!0),t.abrupt("return",e.save());case 15:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"create",value:function(t,e){var r=new N;return r.set("room",t),r.save(e)}},{key:"queryAwards",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=new q.a.Query("award"),t.abrupt("return",r.equalTo("room",e).find().then((function(t){return t.map((function(t){return U.from(t,I)}))})));case 2:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),z=r("5e53"),B=q.a.Object.extend("user"),F=function(){function t(){Object(o["a"])(this,t)}return Object(O["a"])(t,[{key:"login",value:function(t){var e=t.username,r=t.avatar,n=new B;return n.set("username",e),n.set("avatar",r),n.save().then((function(){L.commit("setVisitor",{username:e,avatar:r})}))}},{key:"getUserList",value:function(t){var e=new q.a.Query("user");return e.containedIn("username",t.members).find()}},{key:"getUserListByName",value:function(t){var e=new q.a.Query("user");return e.containedIn("username",t).find().then((function(t){return t.map((function(t){return t.toJSON()}))}))}}]),t}(),J=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.userService=new F,t.realtimeUtil=new Q,t}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"getEnable",value:function(){return this.get("enable")}},{key:"setEnable",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=new Q,!this.valid){t.next=10;break}return t.next=4,e.createConversation(this.attributes.code.toString());case 4:return this._conversation=t.sent,r=q.a.Object.createWithoutData("_Conversation",this._conversation.id),this.set("conversation",r),this.set("enable",!0),t.next=10,this.save();case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getUserList",value:function(){if(!this._conversation)throw Error("房间未启用");return this.userService.getUserList(this._conversation).then((function(t){return t.map((function(t){return t.toJSON()}))}))}},{key:"getConversation",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this._conversation){t.next=2;break}return t.abrupt("return",this._conversation);case 2:if(!this.attributes.enable||!this.valid){t.next=10;break}return e=this.attributes.conversation,t.next=6,this.realtimeUtil.getConversation(e.id);case 6:return this._conversation=t.sent,t.abrupt("return",this._conversation);case 10:return t.abrupt("return",Promise.reject("当前会话未启用"));case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getAwards",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=new T,t.abrupt("return",e.queryAwards(this.object));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"addMessageListener",value:function(){return this._conversation?this.realtimeUtil.addUMessageListener(this._conversation):Object(z["a"])(new Error("会话不存在"))}},{key:"addUserListener",value:function(){return this._conversation?this.realtimeUtil.addUserListener(this._conversation):Object(z["a"])(new Error("会话不存在"))}},{key:"createAward",value:function(t){var e=new T;return e.create(this.object,t)}}]),e}(U),H=q.a.Object.extend("room"),W=function(){function t(){Object(o["a"])(this,t),this.query=new q.a.Query("room")}return Object(O["a"])(t,[{key:"create",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(e){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=new H,t.next=3,this.query.select(["code"]).descending("code").first().then((function(t){return t?t.get("code")+1:1}));case 3:return n=t.sent,a=C()(n+e.password).toString(),Object.entries(e).forEach((function(t){var e=Object(k["a"])(t,2),n=e[0],a=e[1];r.set(n,a)})),r.set("code",n),r.set("token",a),r.set("enable",!1),t.abrupt("return",r.save().then((function(){L.commit("addRoom",a)})).then((function(){return n})));case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"restore",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(e){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.code,n=e.password,a=C()(r+n).toString(),L.commit("addRoom",a);case 3:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getRoom",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.query.equalTo("token",e).include("awards").first();case 2:if(r=t.sent,!r){t.next=7;break}return t.abrupt("return",U.from(r,J));case 7:throw Promise.reject("token 异常");case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getRoomList",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=L.state.rooms,t.abrupt("return",this.query.containedIn("token",e).addDescending("updatedAt").find().then((function(t){return t.map((function(t){return U.from(t,J)}))})));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}]),t}(),G=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.room=null,t.tab="room",t.roomService=new W,t.roomData={},t.currentTab="user-list",t.userList=[],t.awardList=[],t}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"mounted",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.roomService.getRoom(this.token).then((function(t){return t})).catch((function(t){return e.$q.notify({message:t,position:"top"}),null}));case 2:if(this.room=t.sent,this.room){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.room.getConversation();case 7:this.conversation=t.sent,this.room.addUserListener().subscribe((function(t){return e.getUserList()})),this.room.addMessageListener().subscribe(this.onLuckMessage),this.getUserList(),this.getAwardList();case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onLuckMessage",value:function(t){var e=this;if(this.room){var r=JSON.parse(t),n=r.type;"AWARD_RESULT"===n&&this.room.getAwards().then((function(t){e.awardList=t.map((function(t){return t.object.toJSON()}))}))}}},{key:"getUserList",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.room){t.next=5;break}return t.next=3,this.room.getUserList();case 3:e=t.sent,this.userList=e;case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getAwardList",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.room){t.next=5;break}return t.next=3,this.room.getAwards();case 3:e=t.sent,this.awardList=e.map((function(t){return t.attributes}));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getAwardResult",value:function(t){if(!t)return[];var e=t.map((function(t){return t.id}));return this.userList.filter((function(t){return e.includes(t.username)}))}},{key:"luckerIsMe",value:function(t){if(t.result){var e=sessionStorage.getItem("username");return t.result.map((function(t){return t.id})).includes(e)}}},{key:"roomAttr",get:function(){return this.room?this.room.attributes:{}}}]),e}(m["d"]);Object(f["a"])([Object(m["c"])()],G.prototype,"token",void 0),G=Object(f["a"])([Object(m["a"])({components:{}})],G);var V=G,K=V,X=(r("193c"),r("8e6a"),r("b6ec"),Object(b["a"])(K,y,w,!1,null,"4133dc93",null)),Y=X.exports,Z=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",{staticClass:"login-page flex row justify-center items-center"},[r("q-card",{staticClass:"q-ma-md user-container"},[r("q-card-section",{staticClass:"text-center"},[r("q-avatar",{attrs:{size:"5rem"}},[r("img",{attrs:{src:t.user.avatar}})]),r("q-input",{staticClass:"q-ma-md text-center",attrs:{"input-class":"text-center",dense:!0,rounded:"",outlined:""},model:{value:t.user.username,callback:function(e){t.$set(t.user,"username",e)},expression:"user.username"}})],1),r("q-separator"),r("q-card-actions",{attrs:{vertical:""}},[r("q-btn",{attrs:{ripple:"",flat:""},on:{click:t.onLogin}},[t._v("登录")])],1)],1)],1)},tt=[],et=r("359c"),rt=r.n(et),nt=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.userService=new F,t.user={avatar:"",username:""},t}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"mounted",value:function(){this.redirect=this.$route.params.redirect,rt.a.locale="zh_CN",this.user.avatar=rt.a.image.avatar(),this.user.username=rt.a.name.firstName()+rt.a.name.lastName()}},{key:"onLogin",value:function(){var t=this,e="test:".concat(Math.random().toString(36).substr(2));this.userService.login(this.user).then((function(){t.$router.push(t.redirect),sessionStorage.setItem("username",e)})).catch((function(){t.$q.notify("用户名已存在")}))}}]),e}(m["d"]);nt=Object(f["a"])([Object(m["a"])({components:{}})],nt);var at=nt,it=at,st=(r("8599"),Object(b["a"])(it,Z,tt,!1,null,"2ad3ee03",null)),ot=st.exports,ct={path:"/visitor",component:g,children:[{path:"login",name:"login",props:!0,component:ot},{path:"room/:token",name:"visitor-room",props:!0,component:Y}]},ut=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-layout",{staticClass:"browser-layout",attrs:{view:"lHh Lpr lFf"}},[r("q-page-container",[r("router-view")],1)],1)},lt=[],ft=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),e}(m["d"]);ft=Object(f["a"])([m["a"]],ft);var mt=ft,dt=mt,ht=(r("5dfc"),Object(b["a"])(dt,ut,lt,!1,null,"6772f0f8",null)),pt=ht.exports,bt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",{staticClass:"flex flex-center home-page"},[r("div",{staticClass:"home-container shadow-24 bg-img column"},[r("div",{staticClass:"q-mt-xl q-pr-lg text-right"},[r("q-btn",{staticClass:"confirm-button",attrs:{outline:""},on:{click:function(e){t.dialog.modify=!0}}},[t._v("创建房间")])],1),r("q-scroll-area",{ref:"scrollArea",staticClass:"rooms",attrs:{horizontal:"","thumb-style":{display:"none"}}},[r("div",{staticClass:"row no-wrap full-height items-center"},t._l(t.roomSet,(function(t,e){return r("room-card",{key:e,staticClass:"q-ma-md q-mr-xl",attrs:{model:t}})})),1)]),t.roomSet.length?r("div",{staticClass:"q-mb-xl q-pr-lg text-right"},[r("q-btn",{staticClass:"cbg-to-right flip-horizontal",attrs:{round:"",icon:"arrow_right_alt"},on:{click:t.toLeft}}),r("q-btn",{staticClass:"cbg-to-right q-ml-sm",attrs:{round:"",icon:"arrow_right_alt"},on:{click:t.toRight}})],1):t._e()],1),r("q-dialog",{attrs:{persistent:""},model:{value:t.dialog.modify,callback:function(e){t.$set(t.dialog,"modify",e)},expression:"dialog.modify"}},[r("room-modify",{staticStyle:{width:"70%","max-width":"700px"},on:{cancel:function(e){t.dialog.modify=!1},success:t.queryRooms}})],1)],1)},vt=[],gt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"room-card q-pa-md shadow-5 bg-white",on:{click:t.onOpenRoom}},[r("div",{staticClass:"room-header text-no-warp ellipsis"},[r("q-icon",{attrs:{name:"img:/icons/home.svg"}}),t._v("\n    "+t._s(t.model.name)+"\n  ")],1),r("div",{staticClass:"room-comment ellipsis"},[t._v(t._s(t.model.description))]),r("div",{staticClass:"room-footer row justify-between"},[r("div",{staticClass:"current-user text-blue-grey"},[r("q-icon",{attrs:{name:"emoji_people",size:"1.5em",color:"purple"}}),t._v("\n      "+t._s(t.cNum)+"/"+t._s(t.model.limit||"无限制")+"\n    ")],1),r("a",{staticClass:"text-blue-grey-10 cursor-pointer",on:{click:function(e){t.dialog=!0}}},[t._v("⚙进入")])])])},yt=[],wt=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.cNum=0,t.dialog=!1,t}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"onOpenRoom",value:function(){this.$router.push({name:"host-room",params:{token:this.model.token}})}}]),e}(m["d"]);Object(f["a"])([Object(m["c"])({required:!0})],wt.prototype,"model",void 0),wt=Object(f["a"])([Object(m["a"])({name:"RoomCard",components:{}})],wt);var jt=wt,Ot=jt,kt=(r("eb71"),Object(b["a"])(Ot,gt,yt,!1,null,"492f3466",null)),xt=kt.exports,qt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-card",{staticClass:"room-modify shadow-5 bg-img"},[r("div",{staticClass:"flex justify-between items-center q-ma-md"},[r("q-btn",{attrs:{icon:"reply"},on:{click:t.cancel}}),r("div",{staticClass:"text-h5"},[t._v("创建房间")]),r("q-btn",{staticClass:"confirm-button-dialog",attrs:{outline:"",type:"submit"},on:{click:t.submit}},[t._v("确定")])],1),r("q-form",{ref:"form",staticClass:"q-ma-md"},[r("q-input",{attrs:{filled:"",label:"房间名称",rules:t.rules.name},model:{value:t.model.name,callback:function(e){t.$set(t.model,"name",e)},expression:"model.name"}}),r("q-input",{attrs:{filled:"",label:"人数上限",rules:t.rules.limit,min:0,type:"number"},model:{value:t.model.limit,callback:function(e){t.$set(t.model,"limit",t._n(e))},expression:"model.limit"}}),r("q-input",{attrs:{autocomplete:"off",filled:"",label:"房间密码",type:t.isPwd?"password":"text",rules:t.rules.password},scopedSlots:t._u([{key:"append",fn:function(){return[r("q-icon",{staticClass:"cursor-pointer",attrs:{name:t.isPwd?"visibility_off":"visibility"},on:{click:function(e){t.isPwd=!t.isPwd}}})]},proxy:!0}]),model:{value:t.model.password,callback:function(e){t.$set(t.model,"password",e)},expression:"model.password"}}),r("q-toggle",{attrs:{label:"允许重复抽奖"},model:{value:t.model.repeat,callback:function(e){t.$set(t.model,"repeat",e)},expression:"model.repeat"}}),r("q-input",{attrs:{filled:"",label:"房间说明",type:"textarea"},model:{value:t.model.description,callback:function(e){t.$set(t.model,"description",e)},expression:"model.description"}})],1)],1)},_t=[],Ct=r("0378"),Rt=function t(){Object(o["a"])(this,t),this.name="",this.limit=0,this.repeat=!1,this.description="",this.password=""},St=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.roomService=new W,t.isPwd=!0,t.rules={name:[function(t){return!!t||"请输入房间名称"}],limit:[function(t){return""!==t||"请输入房间人数上限,0为无上限"},function(t){return t>-1||"房间至少需要一个人参与"}],password:[function(t){return!!t||"请输入密码,以防止其他人修改房间属性"}]},t.model=new Rt,t}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"cancel",value:function(){var t=this.$refs.form;t.reset()}},{key:"success",value:function(){this.$q.notify({color:"teal",message:"创建房间成功",icon:"tag_faces",position:"top"}),this.model=new Rt,this.cancel()}},{key:"submit",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$refs.form,t.next=3,e.validate();case 3:if(r=t.sent,r){t.next=6;break}return t.abrupt("return");case 6:this.roomService.create(this.model).then(this.success).catch((function(){}));case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}]),e}(m["d"]);Object(f["a"])([Object(m["b"])()],St.prototype,"cancel",null),Object(f["a"])([Object(m["b"])()],St.prototype,"success",null),St=Object(f["a"])([Object(m["a"])({name:"RoomModify",components:{QForm:Ct["a"]}})],St);var Et=St,Lt=Et,At=Object(b["a"])(Lt,qt,_t,!1,null,null,null),$t=At.exports,Pt=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.roomService=new W,t.roomSet=[],t.dialog={modify:!1},t}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"mounted",value:function(){this.scrollArea=this.$refs.scrollArea,this.queryRooms()}},{key:"queryRooms",value:function(){var t=this;this.scrollArea.setScrollPosition(0,500),this.roomService.getRoomList().then((function(e){t.roomSet=e.map((function(t){return t.attributes}))}))}},{key:"toLeft",value:function(){var t=this.scrollArea.getScrollPosition();t<0||this.scrollArea.setScrollPosition(t-600,500)}},{key:"toRight",value:function(){var t=this.scrollArea.getScrollPosition();this.scrollArea.setScrollPosition(t+600,500)}}]),e}(m["d"]);Pt=Object(f["a"])([Object(m["a"])({components:{RoomCard:xt,RoomModify:$t}})],Pt);var Ut=Pt,Dt=Ut,Mt=(r("17c9"),Object(b["a"])(Dt,bt,vt,!1,null,"8df2e524",null)),Qt=Mt.exports,It=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",{staticClass:"flex flex-center room-page"},[r("div",{staticClass:"room-container shadow-5 bg-img"},[r("div",{staticClass:"flex justify-between items-center q-ma-md"},[r("q-btn",{attrs:{icon:"reply"},on:{click:t.back}}),r("div",{staticClass:"text-h5"},[t._v(t._s(t.roomData.name))]),r("q-btn",{attrs:{icon:"share"},on:{click:function(e){t.dialog.qrCode=!0}}})],1),r("div",{staticClass:"row justify-between q-ma-md"},[r("div",{staticClass:"current-user text-blue-gary-10 q-ml-md"},[r("q-icon",{attrs:{name:"emoji_people",size:"1.5em",color:"purple"}}),t._v("\n        "+t._s(t.cNum)+"/"+t._s(t.roomData.limit||"无限制")+"\n      ")],1),r("a",{staticClass:"cursor-pointer",on:{click:function(e){t.dialog.awardModify=!0}}},[t._v("创建奖项")])]),r("div",{staticClass:"content q-mx-lg row"},[r("q-scroll-area",{staticClass:"award-list overflow-scroll q-card",staticStyle:{height:"460px"}},[t.awardList.length?t._l(t.awardList,(function(t,e){return r("award-status",{key:e,attrs:{model:t}})})):r("div",[t._v("暂无奖项")])],2),r("q-scroll-area",{staticClass:"q-ml-md user-icons overflow-scroll q-card",staticStyle:{height:"460px"}},t._l(t.userList,(function(t){return r("q-avatar",{key:t.objectId,staticClass:"q-ma-sm"},[r("img",{attrs:{src:t.avatar}})])})),1)],1)]),r("q-dialog",{model:{value:t.dialog.awardModify,callback:function(e){t.$set(t.dialog,"awardModify",e)},expression:"dialog.awardModify"}},[r("award-modify",{staticStyle:{width:"600px","max-width":"600px"},attrs:{entity:t.roomEntity},on:{cancel:function(e){t.dialog.awardModify=!1},success:t.refreshData}})],1),r("q-dialog",{model:{value:t.dialog.qrCode,callback:function(e){t.$set(t.dialog,"qrCode",e)},expression:"dialog.qrCode"}},[r("room-qrcode",{attrs:{token:t.token}})],1)],1)},Nt=[],Tt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"shadow-1 q-ma-sm text-white cursor-pointer",class:[t.model.finish?"gary-bg":"cbg-to-right "],on:{click:t.startDrawClick}},[r("div",{staticClass:"row justify-between q-px-sm"},[r("div",{staticClass:"text-h6"},[t._v(t._s(t.model.name))]),r("div",[t._v(t._s(t.model.count))])]),r("div",{staticClass:"text-right q-pr-sm status"},[t._v(t._s(t.model.finish?"已开奖":"待开奖"))])])},zt=[],Bt=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"startDrawClick",value:function(){this.$router.push({name:"draw",params:{awardId:this.model.objectId}})}}]),e}(m["d"]);Object(f["a"])([Object(m["c"])()],Bt.prototype,"model",void 0),Bt=Object(f["a"])([Object(m["a"])({name:"AwardStatus"})],Bt);var Ft=Bt,Jt=Ft,Ht=(r("6a54"),Object(b["a"])(Jt,Tt,zt,!1,null,"304820c4",null)),Wt=Ht.exports,Gt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-card",{staticClass:"award-modify shadow-5 bg-img"},[r("div",{staticClass:"flex justify-between items-center q-ma-md"},[r("q-btn",{attrs:{icon:"reply"},on:{click:t.cancel}}),r("div",{staticClass:"text-h5"},[t._v("创建奖项")]),r("q-btn",{staticClass:"confirm-button-dialog",attrs:{outline:"",type:"submit"},on:{click:t.submit}},[t._v("确定")])],1),r("q-form",{ref:"form",staticClass:"q-ma-md"},[r("q-input",{attrs:{filled:"",label:"奖项名称",rules:t.rules.name},model:{value:t.model.name,callback:function(e){t.$set(t.model,"name",e)},expression:"model.name"}}),r("q-input",{attrs:{filled:"",label:"奖项数量",rules:t.rules.count,min:0,type:"number"},model:{value:t.model.count,callback:function(e){t.$set(t.model,"count",t._n(e))},expression:"model.count"}}),r("q-input",{attrs:{filled:"",label:"奖项说明",type:"textarea"},model:{value:t.model.description,callback:function(e){t.$set(t.model,"description",e)},expression:"model.description"}})],1)],1)},Vt=[],Kt=function t(){Object(o["a"])(this,t),this.name="",this.count=0,this.description="",this.finish=!1},Xt=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.awardService=new T,t.rules={name:[function(t){return!!t||"请输入奖项名称"}],count:[function(t){return!!t||"请输入奖项数量"}]},t.model=new Kt,t}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"cancel",value:function(){var t=this.$refs.form;this.model=new Kt,t.reset()}},{key:"success",value:function(){this.$q.notify({color:"teal",message:"奖项创建成功",icon:"tag_faces",position:"top"}),this.cancel()}},{key:"submit",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$refs.form,t.next=3,e.validate();case 3:if(r=t.sent,r){t.next=6;break}return t.abrupt("return");case 6:this.entity.createAward(this.model).then(this.success).catch((function(){}));case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}]),e}(m["d"]);Object(f["a"])([Object(m["c"])()],Xt.prototype,"entity",void 0),Object(f["a"])([Object(m["b"])()],Xt.prototype,"cancel",null),Object(f["a"])([Object(m["b"])()],Xt.prototype,"success",null),Xt=Object(f["a"])([Object(m["a"])({name:"AwardModify",components:{QForm:Ct["a"]}})],Xt);var Yt=Xt,Zt=Yt,te=Object(b["a"])(Zt,Gt,Vt,!1,null,null,null),ee=te.exports,re=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-card",{staticClass:"room-qrcode q-pa-xl"},[r("canvas",{attrs:{id:"my-room"}}),r("div",{staticClass:"text-center"},[t._v("打开扫一扫直接登录")])])},ne=[],ae=(r("a481"),r("d055")),ie=r.n(ae),se=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"onTokenChange",value:function(){var t=window.location.href.replace("host","visitor");this.$nextTick((function(){var e=document.querySelector("#my-room");ie.a.toCanvas(e,t)}))}}]),e}(m["d"]);Object(f["a"])([Object(m["c"])({required:!0})],se.prototype,"token",void 0),Object(f["a"])([Object(m["e"])("token",{immediate:!0})],se.prototype,"onTokenChange",null),se=Object(f["a"])([Object(m["a"])({name:"room-qrcode",components:{}})],se);var oe=se,ce=oe,ue=Object(b["a"])(ce,re,ne,!1,null,null,null),le=ue.exports,fe=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.roomService=new W,t.awardService=new T,t.cNum=0,t.dialog={awardModify:!1,qrCode:!1},t.roomData={},t.userList=[],t.roomEntity=null,t.awardList=[],t}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"mounted",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.token){t.next=2;break}throw Error("无法找到房间");case 2:return t.next=4,this.roomService.getRoom(this.token);case 4:if(this.roomEntity=t.sent,this.roomData=this.roomEntity.object.toJSON(),this.roomEntity.getEnable()){t.next=9;break}return t.next=9,this.roomEntity.setEnable();case 9:return t.next=11,this.roomEntity.getConversation();case 11:this.conversation=t.sent,this.roomEntity.addUserListener().subscribe({next:function(t){e.cNum=t.length,e.getUserList()},error:console.log}),this.refreshData();case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"activated",value:function(){this.refreshData()}},{key:"refreshData",value:function(){var t=this;this.roomEntity&&this.roomEntity.getAwards().then((function(e){t.awardList=e.map((function(t){return t.object.toJSON()}))}))}},{key:"back",value:function(){this.$router.go(-1)}},{key:"getUserList",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.roomEntity){t.next=5;break}return t.next=3,this.roomEntity.getUserList();case 3:e=t.sent,this.userList=e;case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}]),e}(m["d"]);Object(f["a"])([Object(m["c"])()],fe.prototype,"token",void 0),fe=Object(f["a"])([Object(m["a"])({components:{AwardStatus:Wt,AwardModify:ee,RoomQrcode:le}})],fe);var me=fe,de=me,he=(r("196b"),Object(b["a"])(de,It,Nt,!1,null,"8b4a642c",null)),pe=he.exports,be=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",{staticClass:"flex flex-center start-drawing"},[r("div",{staticClass:"draw-container shadow-5"},[r("div",{staticClass:"flex justify-between items-center q-ma-md"},[r("q-btn",{attrs:{icon:"reply"},on:{click:t.back}}),r("div",{staticClass:"text-h5 q-pl-xl"},[t._v(t._s(t.awardData.name))]),r("q-btn",{staticClass:"q-ml-xl confirm-button",attrs:{disable:t.awardData.finish},on:{click:t.luckDrawClick}},[t._v("开始摇奖")])],1),r("div",{staticClass:"q-px-xl row justify-between"},[r("div",[r("q-icon",{attrs:{name:"emoji_people",size:"1.5em",color:"purple"}}),t._v("\n        "+t._s(t.userList.length)+"/"+t._s(t.roomData.limit||"无限制")+"\n      ")],1),r("div",[t._v("\n        将抽取 "),r("span",{staticClass:"text-white"},[t._v(t._s(t.awardData.count))]),t._v(" 名幸运者\n      ")])]),r("q-scroll-area",{staticClass:"q-mt-md q-mx-xl user-icons overflow-scroll q-card",staticStyle:{height:"300px"}},t._l(t.userList,(function(t){return r("q-avatar",{key:t.objectId,staticClass:"q-ma-sm"},[r("img",{attrs:{src:t.avatar}})])})),1),t.luckUsers.length?r("q-scroll-area",{staticClass:"q-mt-md q-mx-xl user-icons overflow-scroll q-card",staticStyle:{height:"150px"}},t._l(t.luckUsers,(function(t){return r("q-avatar",{key:t.objectId,staticClass:"q-ma-sm"},[r("img",{attrs:{src:t.avatar}})])})),1):t._e()],1)])},ve=[],ge=r("c575"),ye=r("b7d7"),we=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.awardService=new T,t.awardData={},t.roomData={},t.userList=[],t.luckUsers=[],t.cNum=20,t.drawFlag=!1,t}return Object(l["a"])(e,t),Object(O["a"])(e,[{key:"back",value:function(){this.$router.go(-1)}},{key:"mounted",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.awardService.getAward(this.awardId);case 2:if(e=t.sent,this.awardData=e.attributes,!this.awardData.finish){t.next=7;break}return this.queryUsers(),t.abrupt("return");case 7:return this.roomData=e.get("room").attributes,this.awardEntity=e,this.roomEntity=U.from(e.get("room"),J),t.next=12,this.roomEntity.getConversation();case 12:this.conversation=t.sent,this.getUserList(),this.roomEntity.addUserListener().subscribe(this.getUserList);case 15:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"luckDrawClick",value:function(){var t=this;this.awardEntity.setResult(this.awardData.count).then((function(e){return t.setLuckUser(e.get("result"))})).catch((function(e){return t.$q.notify({position:"top",message:e})}))}},{key:"getUserList",value:function(){var t=this;this.roomEntity.getUserList().then((function(e){return t.userList=e}))}},{key:"setLuckUser",value:function(t){var e=this,r=t.map((function(t){return t.id})),n={type:"AWARD_RESULT",data:{awardId:this.awardId,userNames:r}};this.conversation.send(new D["TextMessage"](JSON.stringify(n))),Object(ge["a"])(1e3).pipe(Object(ye["a"])(r.length)).subscribe((function(t){var n=e.userList.find((function(e){return e.username===r[t]}));n&&e.luckUsers.push(n)}))}},{key:"queryUsers",value:function(){var t=this,e=new F,r=this.awardData.result.map((function(t){return t.id}));e.getUserListByName(r).then((function(e){return t.luckUsers=e}))}}]),e}(m["d"]);Object(f["a"])([Object(m["c"])()],we.prototype,"awardId",void 0),we=Object(f["a"])([Object(m["a"])({name:"start-drawing",components:{}})],we);var je=we,Oe=je,ke=(r("b5f5"),Object(b["a"])(Oe,be,ve,!1,null,"c749306a",null)),xe=ke.exports,qe={path:"/host",component:pt,children:[{path:"",redirect:"home"},{path:"home",name:"home",component:Qt},{path:"room/:token",name:"host-room",props:!0,component:pe},{path:"start-drawinng/:awardId",name:"draw",props:!0,component:xe}]};n["a"].use(a["a"]);var _e=new a["a"]({mode:"hash",routes:[{path:"",redirect:"/host"},qe,ct]}),Ce=r("9483");Object(Ce["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});r("1f58"),r("5c7d");var Re=r("bf69"),Se=(r("e54f"),r("b05d")),Ee=r("4d5a"),Le=r("9898"),Ae=r("f2cc"),$e=r("c7a0"),Pe=r("2ea3"),Ue=r("65c6"),De=r("6ac5"),Me=r("9c40"),Qe=r("0016"),Ie=r("497d"),Ne=r("6ab5"),Te=r("033f"),ze=r("e208"),Be=r("24e8"),Fe=r("27f9"),Je=r("9564"),He=r("f09f"),We=r("a370"),Ge=r("4b7e"),Ve=r("2a19"),Ke=r("4983"),Xe=r("eb85"),Ye=r("cb32"),Ze=r("429b"),tr=r("7460"),er=r("8562"),rr=r("823b"),nr=r("adad"),ar=r("58a8");n["a"].use(Se["a"],{config:{},components:{QLayout:Ee["a"],QHeader:Le["a"],QDrawer:Ae["a"],QPageContainer:$e["a"],QPage:Pe["a"],QToolbar:Ue["a"],QToolbarTitle:De["a"],QBtn:Me["a"],QIcon:Qe["a"],QList:Ie["a"],QItem:Ne["a"],QItemSection:Te["a"],QItemLabel:ze["a"],QDialog:Be["a"],QInput:Fe["a"],QToggle:Je["a"],QCard:He["a"],QCardActions:Ge["a"],QCardSection:We["a"],QSeparator:Xe["a"],QScrollArea:Ke["a"],QAvatar:Ye["a"],QTabs:Ze["a"],QTab:tr["a"],QSplitter:er["a"],QTabPanel:rr["a"],QTabPanels:nr["a"],QBadge:ar["a"]},directives:{},plugins:{Notify:Ve["a"]},lang:Re["a"]});r("c48b"),r("ac4d"),r("8a81");var ir=function(){function t(e,r){var n=e.router,a=e.store,i=e.launch;Object(o["a"])(this,t),this.applicationStore=r,this.store=a,this.router=n,this.launch=i,this.router.beforeEach(this.routerBeforeEach.bind(this)),this.router.beforeResolve(this.routerBeforeResolve.bind(this)),this.router.afterEach(this.routerAfterEach.bind(this))}return Object(O["a"])(t,[{key:"routerBeforeEach",value:function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(e,r,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!0===this.applicationStore.state.ready||!this.launch){t.next=4;break}return t.next=3,this.launch({store:this.store,router:this.router});case 3:this.applicationStore.commit("ready");case 4:n();case 5:case"end":return t.stop()}}),t,this)})));function e(e,r,n){return t.apply(this,arguments)}return e}()},{key:"routerBeforeResolve",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(r,n,a){var i,s,o,c,u,l,f,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=t.guards,i||0!==t.guards.length){e.next=3;break}return e.abrupt("return",a());case 3:s=!0,o=!1,c=void 0,e.prev=6,u=i[Symbol.iterator]();case 8:if(s=(l=u.next()).done){e.next=19;break}return f=l.value,e.next=12,f({store:this.store,router:this.router},{to:r,from:n,next:a});case 12:if(m=e.sent,void 0===m&&!0===m){e.next=16;break}return a(m),e.abrupt("break",19);case 16:s=!0,e.next=8;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](6),o=!0,c=e.t0;case 25:e.prev=25,e.prev=26,s||null==u.return||u.return();case 28:if(e.prev=28,!o){e.next=31;break}throw c;case 31:return e.finish(28);case 32:return e.finish(25);case 33:return e.abrupt("return",a());case 34:case"end":return e.stop()}}),e,this,[[6,21,25,33],[26,,28,32]])})));function r(t,r,n){return e.apply(this,arguments)}return r}()},{key:"routerAfterEach",value:function(t,e){}}],[{key:"registerGuard",value:function(e){t.guards=[].concat(Object(R["a"])(t.guards),Object(R["a"])(e))}}]),t}();ir.guards=[];var sr=function(){function t(){Object(o["a"])(this,t)}return Object(O["a"])(t,null,[{key:"getStore",value:function(){return this._store||(this._store=this.createStore()),this._store}},{key:"createStore",value:function(){return new S["a"].Store({state:{ready:!1,layout:"loading"},getters:{layout:function(t){return"".concat(t.layout.replace(/^\S/,(function(t){return t.toUpperCase()})),"Layout")}},mutations:{ready:function(t){t.ready=!0},updateLayout:function(t,e){t.layout=e}}})}}]),t}();n["a"].use(a["a"]);var or=function(){function t(e){Object(o["a"])(this,t),this.mixins(),n["a"].use(a["a"]),this.router=new ir(e,sr.getStore()),this.bootstrap(e,(function(){new n["a"]({router:e.router,store:e.store,render:function(t){return t("div",{domProps:{id:"app"}},[t("router-view")])}}).$mount("#app")}))}return Object(O["a"])(t,[{key:"mixins",value:function(){var t=this;n["a"].use({install:function(){n["a"].prototype.$app={router:t.router,store:sr.getStore(),state:sr.getStore().state}}})}},{key:"bootstrap",value:function(t,e){var r=t.store,a=t.bootstrap;a.filters&&Object.entries(a.filters(r)).forEach((function(t){var e=Object(k["a"])(t,2),r=e[0],a=e[1];n["a"].filter(r,a)})),a.directives&&Object.entries(a.directives(r)).forEach((function(t){var e=Object(k["a"])(t,2),r=e[0],a=e[1];n["a"].directive(r,a)})),a.plugins&&Object.entries(a.plugins(r)).forEach((function(t){var e=Object(k["a"])(t,2),r=(e[0],e[1]);n["a"].use(r)})),e()}}]),t}(),cr="PsheKGj7iDalocuWVreooVFw-gzGzoHsz",ur="NR9giTdN1QNRw8Wp2L7Ffeq7",lr=function(){return fr.apply(this,arguments)};function fr(){return fr=Object(j["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:q.a.init({appId:cr,appKey:ur}),globalThis["$realtime"]=new D["Realtime"]({appId:cr,appKey:ur});case 2:case"end":return t.stop()}}),t)}))),fr.apply(this,arguments)}r("f559");var mr=["/visitor/login"];function dr(t){return t.startsWith("/host")}function hr(t){return mr.indexOf(t)>=0}var pr=function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(e,r){var n,a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.router,n=e.store,a=r.to,r.from,i=r.next,dr(a.fullPath)&&!n.state.name&&n.commit("setHost"),dr(a.fullPath)||hr(a.fullPath)||n.state.visitor&&n.state.visitor.username||(s={name:"login",params:{redirect:a.fullPath}}),i(s);case 5:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}();function br(){return new Promise(function(){var t=Object(j["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return ir.registerGuard([pr]),t.next=3,lr();case 3:e();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}var vr=function(t){return{}},gr=function t(){Object(o["a"])(this,t)},yr=function(t){t.store;return gr},wr=function(t){return{}},jr=function(t){t.store;return{}};n["a"].config.productionTip=!1,new or({router:_e,store:L,launch:br,bootstrap:{provides:jr,plugins:wr,directives:vr,filters:yr}})},"17c9":function(t,e,r){"use strict";var n=r("93ea"),a=r.n(n);a.a},"193c":function(t,e,r){"use strict";var n=r("6dbe"),a=r.n(n);a.a},"196b":function(t,e,r){"use strict";var n=r("f87f"),a=r.n(n);a.a},"1f58":function(t,e,r){},4800:function(t,e,r){"use strict";var n=r("acd3"),a=r.n(n);a.a},"5dfc":function(t,e,r){"use strict";var n=r("887a"),a=r.n(n);a.a},"6a54":function(t,e,r){"use strict";var n=r("c099"),a=r.n(n);a.a},"6c88":function(t,e,r){},"6dbe":function(t,e,r){},8447:function(t,e,r){},8599:function(t,e,r){"use strict";var n=r("8447"),a=r.n(n);a.a},"887a":function(t,e,r){},"8e6a":function(t,e,r){"use strict";var n=r("be73"),a=r.n(n);a.a},"93ea":function(t,e,r){},acd3:function(t,e,r){},ae2a:function(t,e,r){},b5f5:function(t,e,r){"use strict";var n=r("ae2a"),a=r.n(n);a.a},b6ec:function(t,e,r){"use strict";var n=r("b94b"),a=r.n(n);a.a},b94b:function(t,e,r){},be73:function(t,e,r){},c099:function(t,e,r){},c48b:function(t,e,r){},eb71:function(t,e,r){"use strict";var n=r("6c88"),a=r.n(n);a.a},f87f:function(t,e,r){}});
//# sourceMappingURL=index.28408483.js.map